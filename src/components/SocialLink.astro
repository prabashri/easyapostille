---
// src/components/SocialLink.astro
import { Icon } from 'astro-icon/components';
import { siteDefaults } from '../config/siteDefaults';

interface Props {
  id?: string;
  className?: string;
  iconSize?: string;
}

const { id = 'social-links', className = '', iconSize = 'w-1-5 h-1-5' } = Astro.props;

const links = siteDefaults.socialLinks;

function getHref(key: string, value: string): string {
  if (value.startsWith('http://') || value.startsWith('https://') || value.startsWith('mailto:')) {
    return value;
  }
  if (key === 'x') {
    return `https://x.com/${value.replace(/^@/, '')}`;
  }
  return `https://${value}`;
}

const baseClass = 'social-links flex gap-05 mi-0 ai-center';
const combinedClass = `${baseClass} ${className}`.trim();
---
<nav aria-label="Social media links" id={id} class="social-media-links flex wrap gap-05">
  {Object.entries(links).map(([key, value]) => {
    if (!value) return null;

    const href = getHref(key, value);
    const label = `Follow us on ${key.charAt(0).toUpperCase() + key.slice(1)}`;

    return (
      <a
        href={href}
        target="_blank"
        rel="noopener noreferrer"
        aria-label={label}
        title={label}
        class="icon-link flex ai-center jc-center p-02 br lh-0 focus-visible"
      >
        <Icon name={key} class={iconSize} />
        <span class="sr-only">{label}</span>
      </a>
    );
  })}
</nav>

