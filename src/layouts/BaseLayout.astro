---
// src/layouts/BaseLayout.astro
import BaseHead from '@/components/BaseHead.astro';
import Header from '@/components/Header.astro';
import Footer from '@/components/Footer.astro';
import AnalyticsHead from '@/components/analytics/AnalyticsHead.astro';
import AnalyticsBodyNoscript from '@/components/analytics/AnalyticsBodyNoscript.astro';
import AnalyticsFooter from '@/components/analytics/AnalyticsFooter.astro';
import ConsentBanner from '@/components/consent/ConsentBanner.astro';
import ConsentData from '@/components/consent/ConsentData.astro';
import InlineScript from '@/components/InlineScript.astro';

import AdSenseHead from '@/components/ads/AdSenseHead.astro';
import AdSenseLoader from '@/components/ads/AdSenseLoader.astro';

import type { HeadProps } from '@/types/HeadProps';
import { siteFunctions } from '@/config/siteFunctions';


const { headProps = { title: 'Default Title', showBreadcrumb: false }, hideHeader = false, hideFooter = false } = Astro.props;
---

<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <slot name="headContent-top" />
    <AnalyticsHead />
    <AdSenseHead /> 
    <BaseHead {...headProps} />
    <slot name="headContent-bottom" />
  </head>
  <body>
    <AnalyticsBodyNoscript />
    <a href="#main-content" class="skip-link">Skip to main content</a>

    {!hideHeader && <Header />}

    <main id="main-content">
      <slot />
    </main>

    {!hideFooter && <Footer />}
    
    {/* ✅ Show consent UI and wire consent updates */}
    <ConsentData />
    <ConsentBanner />

    {/* ✅ Put consent-guarded scripts BEFORE lazy loader */}
    <AnalyticsFooter />
    <AdSenseLoader />
    <InlineScript />

    <slot name="extraScripts" />
  </body>
</html>
